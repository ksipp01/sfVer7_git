using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public partial class EquipConnect : Form
    {
        public EquipConnect()
        {
            InitializeComponent();
        }

             
        private void buttonFocusConnect_Click(object sender, EventArgs e)
        {
            //Pololu.Usc.ScopeFocus.MainWindow m = new Pololu.Usc.ScopeFocus.MainWindow();
          //  m.FocusChooser();
   
            /*
            
            ASCOM.Utilities.Chooser chooser = new ASCOM.Utilities.Chooser();
            chooser.DeviceType = "Focuser";
           m.DevId2 = chooser.Choose();
            //  ASCOM.DriverAccess.Focuser focuser = new ASCOM.DriverAccess.Focuser(devId2);
            if (devId2 != "")
                focuser = new Focuser(devId2);
            else
                return;



            focuser.Connected = true;
            //***************** I think this needs to be changes so it SETs the value not GETs***************
            //go back to previous method for storing the maxtravel in settings, then when gets it 
            //after selecting equipement it sets the value. 
            //****************************************************************************************
            travel = focuser.MaxStep;
            textBox2.Text = travel.ToString();
            count = focuser.Position;
            textBox1.Text = count.ToString();
            Log("connected to " + devId2);
            button8.BackColor = System.Drawing.Color.Lime;
            button8.Text = "Connected";
            /*
            if (focuser.Connected)
            {
                MessageBox.Show("ASCOM Focuser connected");
            }
             

            usingASCOMFocus = true;

            //   focuser.CommandString("C", true);
            */
        }
    }
}
